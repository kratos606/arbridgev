import{r as d,u as f,a as p,j as t}from"./index-Dit8z4pW.js";import"./model-viewer-BMtXc3mG.js";const g=[{name:"subchair",model:"subchair",sizes:{width:.52,height:.84,depth:.52}}];function y(){const s=d.useRef(null),[l,c]=d.useState(null),u=f(),{model:r}=p();d.useEffect(()=>{/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)||u(`/models/${r}`)},[r,u]);const e=g.find(n=>n.model===r);d.useEffect(()=>{(async()=>{if(e){if(!e.sizes){console.log("no resize is needed"),c(`https://ardisplay.ddns.net:3000/models/${r}.glb`);return}try{let o;typeof e.sizes=="object"&&e.sizes!==null&&typeof e.sizes.width=="number"&&typeof e.sizes.height=="number"&&typeof e.sizes.depth=="number"?o={desiredSize:e.sizes}:(console.warn("Invalid modelConfig.sizes, using default size",e.sizes),o={desiredSize:{width:1,height:1,depth:1}});const i=await fetch("https://ardisplay.ddns.net:3000/resize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({modelName:r,...o})});if(!i.ok){console.error("Failed to resize model",i.statusText);return}const a=await i.json();console.log("Model URL","https://ardisplay.ddns.net:3000"+a.url),c("https://ardisplay.ddns.net:3000"+a.url)}catch(o){console.error("Error fetching resized model:",o)}}})()},[r,e]);const h=n=>{if(s.current){const o=s.current.shadowRoot.querySelector(".progress-bar"),i=s.current.shadowRoot.querySelector(".update-bar"),a=n.detail.progress;o&&i&&(i.style.width=`${a*100}%`)}},m=()=>{s.current&&(s.current.cameraOrbit="0deg 90deg 1m")};return t.jsxs("div",{style:{width:"100vw",height:"100vh",overflow:"hidden"},children:[l&&t.jsxs("model-viewer",{ref:s,src:l,ar:!0,"ar-modes":"webxr scene-viewer quick-look","camera-controls":!0,"environment-image":"/brown_photostudio_02_1k.hdr","skybox-image":"/brown_photostudio_02_1k.hdr","shadow-intensity":"1","shadow-softness":"1",exposure:"1","auto-rotate":!0,"interaction-prompt":"auto","auto-rotate-delay":"0","rotation-per-second":"30deg","field-of-view":"30deg","min-camera-orbit":"auto auto auto","max-camera-orbit":"auto auto auto","min-field-of-view":"10deg","max-field-of-view":"45deg",bounds:"tight","ar-placement":"floor","placement-mode":"automatic","shadow-root-opacity":"0.8","environment-intensity":"1","ar-scale":"fixed","tone-mapping":"commerce",style:{backgroundColor:"#f8f8f8",width:"100%",height:"100%"},onProgress:h,children:[t.jsx("div",{className:"progress-bar",slot:"progress-bar",children:t.jsx("div",{className:"update-bar"})}),t.jsx("button",{slot:"ar-button",className:"ar-button",children:"AR View"})]}),t.jsx("div",{className:"controls",children:t.jsx("button",{id:"resetPosition",onClick:m,children:"Reset"})})]})}export{y as default};
